create or replace view ods.crm.ods_v_crm_promotion_details as
select
    a.*,
    sub_list.value:applyAmount::STRING as apply_amount,
    sub_list.value:cmDeptIds::STRING as cm_dept_ids,
    sub_list.value:cmDeptNames::STRING as cm_dept_names,
    sub_list.value:cmDistrictIds::STRING as cm_district_ids,
    sub_list.value:cmDistrictNames::STRING as cm_district_names,
    sub_list.value:cmKaSys::STRING as cm_ka_sys,
    sub_list.value:cmKaSysIds::STRING as cm_ka_sys_ids,
    sub_list.value:cmManagerCode::STRING as cm_manager_code,
    sub_list.value:cmManagerDept::STRING as cm_manager_dept,
    sub_list.value:cmManagerId::STRING as cm_manager_id,
    sub_list.value:cmManagerName::STRING as cm_manager_name,
    sub_list.value:cmManagerSourceCode::STRING as cm_manager_source_code,
    sub_list.value:cmQualifiedStatus::STRING as cm_qualified_status,
    sub_list.value:cmReceiveAddrId::STRING as cm_receive_addr_id,
    sub_list.value:cmReceiveAddrName::STRING as cm_receive_addr_name,
    sub_list.value:cmReceiveCode::STRING as cm_receive_code,
    sub_list.value:cmReceiveId::STRING as cm_receive_id,
    sub_list.value:cmReceiveName::STRING as cm_receive_name,
    sub_list.value:cmReceiveSourceCode::STRING as cm_receive_source_code,
    sub_list.value:cmTypeIds::STRING as cm_type_ids,
    sub_list.value:cmTypeNames::STRING as cm_type_names,
    sub_list.value:cusCode::STRING as cus_code,
    sub_list.value:cusId::STRING as cus_id,
    sub_list.value:cusName::STRING as cus_name,
    sub_list.value:cusSourceCode::STRING as cus_source_code,
    sub_list.value:dealerCode::STRING as dealer_code,
    sub_list.value:dealerName::STRING as dealer_name,
    sub_list.value:dealerSourceCode::STRING as dealer_source_code,
    sub_list.value:dimInfoList::STRING as dim_info_list,
    sub_list.value:dimJson::STRING as dim_json,
    sub_list.value:endDate::STRING as end_date,
    sub_list.value:exeRequire::STRING as exe_require,
    sub_list.value:extColumns::STRING as item_ext_columns,
    sub_list.value:giftCode::STRING as gift_code,
    sub_list.value:giftId::STRING as gift_id,
    sub_list.value:giftName::STRING as gift_name,
    sub_list.value:giftNum::STRING as gift_num,
    sub_list.value:giftPrice::STRING as gift_price,
    sub_list.value:giftSourceCode::STRING as gift_source_code,
    sub_list.value:giftUnitId::STRING as gift_unit_id,
    sub_list.value:giftUnitName::STRING as gift_unit_name,
    sub_list.value:inputNum::STRING as input_num,
    sub_list.value:inputStandard::STRING as input_standard,
    sub_list.value:itemCostStd::STRING as item_cost_std,
    sub_list.value:itemName::STRING as item_name,
    sub_list.value:joinCmNum::STRING as join_cm_num,
    sub_list.value:payType::STRING as pay_type,
    sub_list.value:pdBrandsName::STRING as pd_brands_name,
    sub_list.value:pdCodes::STRING as pd_codes,
    sub_list.value:pdIds::STRING as pd_ids,
    sub_list.value:pdNames::STRING as pd_names,
    sub_list.value:pdRangeType::STRING as pd_range_type,
    sub_list.value:pdSale::STRING as pd_sale,
    sub_list.value:pdSalesAmount::STRING as pd_sales_amount,
    sub_list.value:pdSalesVolume::STRING as pd_sales_volume,
    sub_list.value:pdSourceCodes::STRING as pd_source_codes,
    sub_list.value:pdTypesName::STRING as pd_types_name,
    sub_list.value:pdUnitId::STRING as pd_unit_id,
    sub_list.value:pdUnitName::STRING as pd_unit_name,
    sub_list.value:period::STRING as period,
    sub_list.value:promotionDays::STRING as promotion_days,
    sub_list.value:remark::STRING as remark,
    sub_list.value:rowNo::STRING as row_no,
    sub_list.value:settlementOrgCode::STRING as settlement_org_code,
    sub_list.value:settlementOrgId::STRING as settlement_org_id,
    sub_list.value:settlementOrgName::STRING as settlement_org_name,
    sub_list.value:settlementOrgSourceCode::STRING as settlement_org_source_code,
    sub_list.value:status::STRING as item_status,
    sub_list.value:subId::STRING as sub_id,
    sub_list.value:subject::STRING as subject,
    sub_list.value:subjectCode::STRING as subject_code
from
    ods.crm.ods_t_crm_promotions_details as a,
    lateral FLATTEN(input => PARSE_JSON(a.sub_list)) as sub_list;